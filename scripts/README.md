# IoTGoat Backdoor Detection Script

This script is designed to automate the process of backdoor detection for the IoTGoat research challenge. It takes an XML file generated by an Nmap scan of IoTGoat devices and checks for potential backdoors on open ports with an unknown service.

## Prerequisites

- Python 3
- `pwntools` library (`pip install pwntools`)
- Nmap XML file containing the scan results of IoTGoat devices

## Usage

1. Clone the repository and navigate to the project directory.
2. Install the required dependencies using `pip install -r requirements.txt`.
3. Run the script with the following command:

```shell
python3 backdoor_checker.py <xml_file>
```

Replace `<xml_file>` with the path to the Nmap XML file containing the scan results.

## How It Works

The script utilizes the `xml.etree.ElementTree` module to parse the provided XML file and extract information about hosts, ports, and services. It then iterates over the hosts and checks for open ports with an unknown service. For each potential backdoor port, the script performs the following steps:

1. Establishes a connection to the port using the `pwntools` library's `remote()` function.
2. Clears any existing data received from the connection.
3. Sends the `id` command to the port.
4. Receives the response with a timeout.
5. Checks if the response contains the string `'uid='`, indicating a successful command execution and potential backdoor presence.
6. Prints the appropriate output message based on the detection result.
7. Closes the connection.

The script handles exceptions during the connection process and provides error messages if any issues occur.

## Output

The script provides detailed output during the detection process. It displays the following information for each checked port:

- Checking port number for potential backdoor.
- Debug messages indicating the connection status and sent commands.
- Debug message showing the received response.
- Detection result message indicating whether a backdoor is detected or not.

## Example

```shell
python3 backdoor_checker.py ~/iotgoat/nmap/iotgoat.xml
```

Output:

```
Checking port 5515 for potential backdoor...
[+] Opening connection to 192.168.117.131 on port 5515: Done
[DEBUG] Connected to 192.168.117.131:5515
[DEBUG] Sent "id" command
[DEBUG] Received response: uid=0(root) gid=0(root)
Backdoor detected on port 5515! Response: uid=0(root) gid=0(root)
[*] Closed connection to 192.168.117.131 port 5515
```

## Notes

- The script assumes that the Nmap XML file contains accurate scan results for the IoTGoat devices.
- It is recommended to review the script, customize it, and perform additional checks based on specific requirements and considerations.
- This script is provided as a starting point for backdoor detection
